<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ganesa Hub | Platform Produktivitas Enterprise</title>

    <!-- Professional Meta Tags -->
    <meta
      name="description"
      content="Platform produktivitas enterprise dengan AI assistant terintegrasi dan Telegram Bot untuk manajemen tugas, keuangan, dan goals yang seamless"
    />
    <meta
      name="keywords"
      content="produktivitas, AI assistant, manajemen tugas, keuangan, goals, telegram bot"
    />
    <meta name="author" content="Ganesa Hub" />

    <!-- Open Graph -->
    <meta
      property="og:title"
      content="Ganesa Hub - Platform Produktivitas Enterprise"
    />
    <meta
      property="og:description"
      content="Platform produktivitas all-in-one dengan AI assistant dan Telegram Bot integration"
    />
    <meta property="og:image" content="/assets/og-image.jpg" />
    <meta property="og:url" content="https://ganesahub.com" />

    <!-- Preload Critical Resources -->
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      as="style"
    />

    <!-- Professional Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      /* ===== PROFESSIONAL DESIGN SYSTEM ===== */
      :root {
        /* Enterprise Color Palette - Sesuai Permintaan */
        --mist: #90afc5;
        --stone: #336b87;
        --shadow: #2a3132;
        --autumn-foliage: #763626;

        /* Derived Colors */
        --primary-blue: var(--stone);
        --secondary-blue: var(--shadow);
        --accent-blue: var(--mist);
        --light-blue: #f0f7ff;
        --success: #38a169;
        --warning: #d69e2e;
        --error: #e53e3e;

        /* Neutral Colors */
        --white: #ffffff;
        --gray-50: #f7fafc;
        --gray-100: #edf2f7;
        --gray-200: #e2e8f0;
        --gray-300: #cbd5e0;
        --gray-400: #a0aec0;
        --gray-500: #718096;
        --gray-600: #4a5568;
        --gray-700: #2d3748;
        --gray-800: #1a202c;
        --gray-900: #171923;

        /* Current Theme */
        --bg: var(--white);
        --bg-alt: var(--gray-50);
        --card-bg: var(--white);
        --text-primary: var(--shadow);
        --text-secondary: var(--gray-600);
        --text-muted: var(--gray-500);
        --border: var(--gray-200);
        --accent: var(--stone);
        --accent-light: var(--mist);
        --shadow: 0 1px 3px rgba(42, 49, 50, 0.1);
        --shadow-lg: 0 10px 40px rgba(42, 49, 50, 0.08);
      }

      [data-theme="dark"] {
        --bg: var(--shadow);
        --bg-alt: #363d3e;
        --card-bg: #363d3e;
        --text-primary: var(--gray-100);
        --text-secondary: var(--gray-300);
        --text-muted: var(--gray-400);
        --border: #4a5253;
        --accent: var(--mist);
        --accent-light: #a8c6d8;
        --shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.2);
      }

      /* ===== PROFESSIONAL BASE STYLES ===== */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html,
      body {
        height: 100%;
        font-family: "Inter", "SF Pro Display", -apple-system,
          BlinkMacSystemFont, sans-serif;
        background: var(--bg);
        color: var(--text-primary);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        line-height: 1.6;
      }

      body {
        padding: 16px;
        min-height: 100vh;
      }

      /* ===== ENTERPRISE TYPOGRAPHY ===== */
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-weight: 600;
        line-height: 1.3;
        color: var(--text-primary);
        letter-spacing: -0.02em;
      }

      h1 {
        font-size: clamp(1.75rem, 4vw, 2.5rem);
      }
      h2 {
        font-size: clamp(1.5rem, 3.5vw, 2rem);
      }
      h3 {
        font-size: clamp(1.25rem, 3vw, 1.5rem);
      }
      h4 {
        font-size: clamp(1.125rem, 2.5vw, 1.25rem);
      }
      h5 {
        font-size: clamp(1rem, 2vw, 1.125rem);
      }
      h6 {
        font-size: clamp(0.875rem, 1.8vw, 1rem);
      }

      .text-body {
        font-size: clamp(0.875rem, 2vw, 1rem);
        color: var(--text-secondary);
      }
      .text-small {
        font-size: clamp(0.75rem, 1.8vw, 0.875rem);
        color: var(--text-muted);
      }
      .text-caption {
        font-size: clamp(0.65rem, 1.6vw, 0.75rem);
        color: var(--text-muted);
      }

      /* ===== PROFESSIONAL LAYOUT ===== */
      .container {
        max-width: 1400px;
        margin: 0 auto;
        width: 100%;
        display: grid;
        grid-template-columns: minmax(250px, 300px) 1fr;
        gap: 20px;
      }

      header {
        grid-column: 1 / -1;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: center;
        gap: 16px;
        padding: 0 0 24px 0;
        border-bottom: 1px solid var(--border);
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .logo-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, var(--stone), var(--mist));
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 700;
        font-size: 18px;
        box-shadow: var(--shadow-lg);
        flex-shrink: 0;
      }

      /* ===== ENTERPRISE CARD SYSTEM ===== */
      .card {
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 20px;
        box-shadow: var(--shadow);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .card:hover {
        box-shadow: var(--shadow-lg);
        transform: translateY(-2px);
      }

      .card-header {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: center;
        gap: 12px;
        margin-bottom: 16px;
      }

      /* ===== PROFESSIONAL NAVIGATION ===== */
      .sidebar {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .nav-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 14px 16px;
        border-radius: 10px;
        color: var(--text-secondary);
        text-decoration: none;
        transition: all 0.3s ease;
        font-weight: 500;
        border: 1px solid transparent;
        cursor: pointer;
        font-size: clamp(0.8rem, 1.8vw, 0.9rem);
      }

      .nav-item:hover {
        background: var(--bg-alt);
        color: var(--text-primary);
        border-color: var(--border);
      }

      .nav-item.active {
        background: linear-gradient(135deg, var(--stone), var(--mist));
        color: white;
        box-shadow: var(--shadow-lg);
      }

      .nav-item .icon {
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
        flex-shrink: 0;
      }

      /* ===== MAIN CONTENT ===== */
      main {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .panel {
        display: none;
        animation: fadeInUp 0.6s ease-out;
      }

      .panel.active {
        display: block;
      }

      /* ===== ENTERPRISE GRID SYSTEMS ===== */
      .grid-2 {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
      }

      .grid-3 {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
      }

      .grid-4 {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
      }

      .grid-auto {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 16px;
      }

      /* ===== PROFESSIONAL FORM ELEMENTS ===== */
      .form-group {
        margin-bottom: 16px;
      }

      .form-label {
        display: block;
        margin-bottom: 6px;
        font-weight: 500;
        color: var(--text-secondary);
        font-size: clamp(0.75rem, 1.8vw, 0.875rem);
      }

      .form-input {
        width: 100%;
        padding: 12px 14px;
        border: 1px solid var(--border);
        border-radius: 10px;
        background: var(--bg);
        color: var(--text-primary);
        font-size: clamp(0.875rem, 2vw, 1rem);
        transition: all 0.3s ease;
      }

      .form-input:focus {
        outline: none;
        border-color: var(--stone);
        box-shadow: 0 0 0 3px rgba(51, 107, 135, 0.1);
      }

      textarea.form-input {
        min-height: 100px;
        resize: vertical;
        line-height: 1.6;
      }

      /* ===== ENTERPRISE BUTTON SYSTEM ===== */
      .btn {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        padding: 10px 20px;
        border: none;
        border-radius: 10px;
        font-size: clamp(0.75rem, 1.8vw, 0.875rem);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        text-align: center;
        white-space: nowrap;
      }

      .btn-primary {
        background: linear-gradient(135deg, var(--stone), var(--mist));
        color: white;
        box-shadow: var(--shadow);
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
      }

      .btn-secondary {
        background: var(--bg-alt);
        color: var(--text-secondary);
        border: 1px solid var(--border);
      }

      .btn-secondary:hover {
        background: var(--border);
        color: var(--text-primary);
      }

      .btn-success {
        background: var(--success);
        color: white;
      }

      .btn-danger {
        background: var(--error);
        color: white;
      }

      .btn-warning {
        background: var(--warning);
        color: white;
      }

      .btn-sm {
        padding: 8px 14px;
        font-size: clamp(0.7rem, 1.6vw, 0.75rem);
      }

      .btn-icon {
        padding: 10px;
        width: 40px;
        height: 40px;
      }

      /* ===== PROFESSIONAL LIST SYSTEMS ===== */
      .list {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .list-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px;
        border-bottom: 1px solid var(--border);
        transition: background 0.3s ease;
      }

      .list-item:hover {
        background: var(--bg-alt);
      }

      .list-item:last-child {
        border-bottom: none;
      }

      /* ===== ENTERPRISE PROGRESS & STATUS ===== */
      .progress-bar {
        height: 6px;
        background: var(--border);
        border-radius: 3px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--stone), var(--mist));
        transition: width 0.5s ease;
      }

      .status-badge {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 4px 10px;
        border-radius: 16px;
        font-size: clamp(0.65rem, 1.6vw, 0.75rem);
        font-weight: 600;
      }

      .status-success {
        background: #c6f6d5;
        color: #22543d;
      }

      .status-warning {
        background: #fefcbf;
        color: #744210;
      }

      .status-error {
        background: #fed7d7;
        color: #742a2a;
      }

      /* ===== ADVANCED VOICE ASSISTANT ===== */
      .voice-assistant {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
      }

      .voice-btn {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--stone), var(--mist));
        border: none;
        color: white;
        font-size: 20px;
        cursor: pointer;
        box-shadow: 0 8px 24px rgba(42, 49, 50, 0.15);
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .voice-btn.listening {
        background: linear-gradient(135deg, var(--autumn-foliage), #a85534);
        animation: pulse 2s infinite;
      }

      .voice-panel {
        position: fixed;
        bottom: 100px;
        right: 20px;
        width: min(90vw, 400px);
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 20px;
        box-shadow: 0 16px 48px rgba(42, 49, 50, 0.2);
        display: none;
        z-index: 1001;
      }

      .voice-panel.active {
        display: block;
        animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .voice-transcript {
        background: var(--bg-alt);
        padding: 16px;
        border-radius: 12px;
        margin-bottom: 16px;
        min-height: 60px;
        border: 1px solid var(--border);
        font-size: clamp(0.875rem, 2vw, 1rem);
        line-height: 1.6;
      }

      .voice-response {
        background: rgba(144, 175, 197, 0.1);
        padding: 16px;
        border-radius: 12px;
        border: 1px solid rgba(144, 175, 197, 0.2);
        font-size: clamp(0.875rem, 2vw, 1rem);
        color: var(--text-secondary);
        line-height: 1.6;
      }

      /* ===== TELEGRAM BOT INTEGRATION ===== */
      .telegram-integration {
        background: linear-gradient(135deg, var(--stone), var(--mist));
        color: white;
        padding: 20px;
        border-radius: 12px;
      }

      .telegram-commands {
        background: rgba(255, 255, 255, 0.1);
        padding: 14px;
        border-radius: 10px;
        margin-top: 14px;
      }

      /* ===== FINANCIAL COMPONENTS ===== */
      .financial-card {
        background: linear-gradient(135deg, var(--stone), var(--mist));
        color: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: var(--shadow-lg);
      }

      .amount {
        font-size: clamp(1.5rem, 4vw, 2.5rem);
        font-weight: 700;
        margin: 10px 0;
      }

      .trend {
        display: flex;
        align-items: center;
        gap: 4px;
        font-size: clamp(0.75rem, 1.8vw, 0.875rem);
      }

      .trend.positive {
        color: #68d391;
      }

      .trend.negative {
        color: #fc8181;
      }

      /* ===== TOAST NOTIFICATIONS ===== */
      .toast-container {
        position: fixed;
        top: 20px;
        right: 20px;
        left: 20px;
        z-index: 2000;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .toast {
        padding: 14px 18px;
        border-radius: 10px;
        background: var(--card-bg);
        border: 1px solid var(--border);
        box-shadow: var(--shadow-lg);
        display: flex;
        align-items: center;
        gap: 10px;
        animation: slideInRight 0.3s ease;
        max-width: 100%;
      }

      .toast-success {
        border-left: 4px solid var(--success);
      }

      .toast-error {
        border-left: 4px solid var(--error);
      }

      .toast-warning {
        border-left: 4px solid var(--warning);
      }

      .toast-info {
        border-left: 4px solid var(--mist);
      }

      /* ===== LOADING STATES ===== */
      .skeleton {
        background: linear-gradient(
          90deg,
          var(--border) 25%,
          var(--bg-alt) 50%,
          var(--border) 75%
        );
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
        border-radius: 6px;
      }

      .loading-spinner {
        width: 18px;
        height: 18px;
        border: 2px solid var(--border);
        border-top: 2px solid var(--stone);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      /* ===== PROFESSIONAL ANIMATIONS ===== */
      @keyframes slideUp {
        from {
          transform: translateY(30px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      @keyframes fadeInUp {
        from {
          transform: translateY(20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
          box-shadow: 0 8px 24px rgba(42, 49, 50, 0.15);
        }
        50% {
          transform: scale(1.05);
          box-shadow: 0 12px 32px rgba(42, 49, 50, 0.2);
        }
        100% {
          transform: scale(1);
          box-shadow: 0 8px 24px rgba(42, 49, 50, 0.15);
        }
      }

      @keyframes slideInRight {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      @keyframes loading {
        0% {
          background-position: 200% 0;
        }
        100% {
          background-position: -200% 0;
        }
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* ===== UTILITY CLASSES ===== */
      .flex {
        display: flex;
      }
      .flex-col {
        flex-direction: column;
      }
      .items-center {
        align-items: center;
      }
      .justify-between {
        justify-content: space-between;
      }
      .gap-4 {
        gap: 16px;
      }
      .gap-6 {
        gap: 20px;
      }
      .gap-2 {
        gap: 8px;
      }
      .w-full {
        width: 100%;
      }
      .hidden {
        display: none;
      }

      .text-center {
        text-align: center;
      }
      .text-right {
        text-align: right;
      }

      .mb-4 {
        margin-bottom: 16px;
      }
      .mb-6 {
        margin-bottom: 20px;
      }
      .mb-2 {
        margin-bottom: 8px;
      }
      .mt-4 {
        margin-top: 16px;
      }
      .mt-6 {
        margin-top: 20px;
      }

      /* ===== SECURITY BADGES ===== */
      .security-badge {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 4px 10px;
        background: rgba(56, 161, 105, 0.1);
        color: var(--success);
        border-radius: 16px;
        font-size: clamp(0.65rem, 1.6vw, 0.75rem);
        font-weight: 600;
      }

      /* ===== RESPONSIVE DESIGN ===== */
      @media (max-width: 1024px) {
        .container {
          grid-template-columns: 1fr;
          gap: 16px;
        }

        .sidebar {
          order: 2;
        }

        .grid-2,
        .grid-3,
        .grid-4 {
          grid-template-columns: 1fr;
        }

        .voice-panel {
          width: calc(100vw - 40px);
          right: 20px;
          left: 20px;
        }
      }

      @media (max-width: 768px) {
        body {
          padding: 12px;
        }

        .container {
          gap: 12px;
        }

        .card {
          padding: 16px;
        }

        header {
          flex-direction: column;
          align-items: flex-start;
          gap: 12px;
        }

        .logo {
          width: 100%;
          justify-content: center;
        }

        .header-actions {
          width: 100%;
          justify-content: space-between;
        }

        .btn {
          padding: 8px 16px;
        }

        .voice-btn {
          width: 50px;
          height: 50px;
          font-size: 18px;
        }

        .toast-container {
          top: 12px;
          right: 12px;
          left: 12px;
        }
      }

      @media (max-width: 480px) {
        body {
          padding: 8px;
        }

        .card {
          padding: 14px;
        }

        .nav-item {
          padding: 12px 14px;
        }

        .form-input {
          padding: 10px 12px;
        }

        .btn {
          padding: 8px 14px;
          font-size: 0.7rem;
        }

        .voice-btn {
          width: 45px;
          height: 45px;
          font-size: 16px;
        }
      }

      /* ===== MOBILE MENU ===== */
      .mobile-menu-btn {
        display: none;
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: var(--text-primary);
      }

      @media (max-width: 1024px) {
        .mobile-menu-btn {
          display: block;
        }

        .sidebar {
          display: none;
        }

        .sidebar.active {
          display: flex;
        }
      }

      /* ===== INTEGRATION STATUS ===== */
      .integration-status {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 500;
      }

      .integration-connected {
        background: rgba(56, 161, 105, 0.1);
        color: var(--success);
      }

      .integration-disconnected {
        background: rgba(229, 62, 62, 0.1);
        color: var(--error);
      }
    </style>
</head>
<body>
    <!-- Toast Notifications Container -->
    <div class="toast-container" id="toastContainer"></div>

    <div class="container">
      <!-- Professional Header -->
      <header>
        <div class="logo">
          <div class="logo-icon">G</div>
          <div>
            <h1>Ganesa Hub</h1>
            <div class="text-small">Platform Produktivitas Enterprise</div>
          </div>
        </div>

        <div class="flex items-center gap-6 header-actions">
          <div class="security-badge">
            <span>üîí</span>
            <span>Data Terenkripsi</span>
          </div>
          <div class="text-small" id="currentDateTime">‚Äî</div>
          <button class="btn btn-secondary btn-sm" id="themeToggle">
            <span class="icon">üåô</span>
          </button>
          <button class="btn btn-secondary btn-sm" id="telegramSetup">
            <span class="icon">üì±</span>
            <span>Telegram Bot</span>
          </button>
          <button class="mobile-menu-btn" id="mobileMenuBtn">
            ‚ò∞
          </button>
        </div>
      </header>

      <!-- Enterprise Navigation -->
      <nav class="card sidebar" id="sidebar">
        <div class="nav-item active" data-panel="dashboard">
          <span class="icon">üìä</span>
          <span>Dashboard Eksekutif</span>
        </div>
        <div class="nav-item" data-panel="tasks">
          <span class="icon">‚úÖ</span>
          <span>Manajemen Tugas</span>
        </div>
        <div class="nav-item" data-panel="journal">
          <span class="icon">üìù</span>
          <span>Jurnal & Catatan</span>
        </div>
        <div class="nav-item" data-panel="goals">
          <span class="icon">üéØ</span>
          <span>Goals & Target</span>
        </div>
        <div class="nav-item" data-panel="finance">
          <span class="icon">üí∞</span>
          <span>Manajemen Keuangan</span>
        </div>
        <div class="nav-item" data-panel="analytics">
          <span class="icon">üìà</span>
          <span>Analisis Lanjutan</span>
        </div>
        <div class="nav-item" data-panel="integrations">
          <span class="icon">üîó</span>
          <span>Integrasi</span>
        </div>

        <div class="mt-6 pt-6 border-t border-gray-200">
          <div class="text-caption mb-4">Asisten AI</div>
          <div class="text-small text-muted">
            Perintah suara & integrasi Telegram Bot untuk manajemen
            produktivitas yang mulus
          </div>
        </div>
      </nav>

      <!-- Main Content -->
      <main>
        <!-- Executive Dashboard -->
        <section class="panel card active" id="dashboard">
          <div class="card-header">
            <h2>Dashboard Eksekutif</h2>
            <div class="text-body" id="greetingText">
              Selamat datang kembali
            </div>
          </div>

          <div class="grid-4 mb-6">
            <div class="card text-center">
              <div class="text-small text-muted mb-2">Skor Produktivitas</div>
              <div class="amount" id="productivityScore">0%</div>
              <div class="progress-bar mt-2">
                <div class="progress-fill" id="productivityBar"></div>
              </div>
            </div>

            <div class="card text-center">
              <div class="text-small text-muted mb-2">Tugas Selesai</div>
              <div class="amount" id="completedTasks">0</div>
              <div class="text-small">
                dari <span id="totalTasks">0</span> total
              </div>
            </div>

            <div class="financial-card">
              <div class="text-small mb-2">Saldo Saat Ini</div>
              <div class="amount" id="currentBalance">Rp 0</div>
              <div class="trend positive" id="balanceTrend">
                <span>‚Üó</span>
                <span>Stabil</span>
              </div>
            </div>

            <div class="card text-center">
              <div class="text-small text-muted mb-2">Progress Goals</div>
              <div class="amount" id="goalsProgress">0%</div>
              <div class="text-small">
                <span id="completedGoals">0</span> goals tercapai
              </div>
            </div>
          </div>

          <div class="grid-2">
            <div class="card">
              <div class="flex justify-between items-center mb-4">
                <h4>Fokus Hari Ini</h4>
                <button class="btn btn-warning btn-sm" id="resetFocus">
                  Reset
                </button>
              </div>
              <div class="form-group">
                <input
                  type="text"
                  class="form-input"
                  id="dailyFocus"
                  placeholder="Apa fokus utama Anda hari ini?"
                />
              </div>
              <div class="flex gap-2">
                <button class="btn btn-primary btn-sm" id="saveFocus">
                  Simpan Fokus
                </button>
                <button class="btn btn-secondary btn-sm" id="clearFocus">
                  Hapus
                </button>
              </div>
            </div>

            <div class="card">
              <div class="flex justify-between items-center mb-4">
                <h4>Catatan Cepat</h4>
                <button class="btn btn-warning btn-sm" id="resetNote">
                  Reset
                </button>
              </div>
              <div class="form-group">
                <textarea
                  class="form-input"
                  id="quickNote"
                  placeholder="Catatan atau ide penting..."
                ></textarea>
              </div>
              <button class="btn btn-primary btn-sm" id="saveNote">
                Simpan Catatan
              </button>
            </div>
          </div>
        </section>

        <!-- Task Management -->
        <section class="panel card" id="tasks">
          <div class="card-header">
            <h2>Manajemen Tugas</h2>
            <div class="text-body">
              Pelacakan tugas profesional dengan prioritas dan deadline
            </div>
          </div>

          <div class="grid-2">
            <div>
              <div class="flex justify-between items-center mb-4">
                <h4>Tambah Tugas Baru</h4>
                <button class="btn btn-warning btn-sm" id="resetTaskForm">
                  Reset Form
                </button>
              </div>
              <div class="form-group">
                <label class="form-label">Deskripsi Tugas</label>
                <input
                  type="text"
                  class="form-input"
                  id="taskInput"
                  placeholder="Apa yang perlu dikerjakan?"
                />
              </div>
              <div class="form-group">
                <label class="form-label">Prioritas</label>
                <select class="form-input" id="taskPriority">
                  <option value="low">Prioritas Rendah</option>
                  <option value="medium" selected>Prioritas Menengah</option>
                  <option value="high">Prioritas Tinggi</option>
                  <option value="critical">Kritis</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Deadline</label>
                <input type="date" class="form-input" id="taskDeadline" />
              </div>
              <div class="flex gap-2">
                <button class="btn btn-primary" id="addTask">Tambah Tugas</button>
                <button class="btn btn-danger" id="resetAllTasks">Reset Semua Tugas</button>
              </div>
            </div>

            <div>
              <div class="flex justify-between items-center mb-4">
                <h4>Daftar Tugas</h4>
                <div class="flex gap-2">
                  <div class="text-small text-muted" id="taskStats">0 tugas</div>
                  <button class="btn btn-warning btn-sm" id="clearCompletedTasks">
                    Hapus Selesai
                  </button>
                </div>
              </div>
              <div class="list" id="taskList">
                <!-- Tasks will be populated here -->
              </div>
            </div>
          </div>
        </section>

        <!-- Journal & Notes -->
        <section class="panel card" id="journal">
          <div class="card-header">
            <h2>Jurnal & Catatan</h2>
            <div class="text-body">
              Dokumentasikan pemikiran, ide, dan refleksi Anda
            </div>
          </div>

          <div class="grid-2">
            <div>
              <div class="flex justify-between items-center mb-4">
                <h4>Entri Jurnal Baru</h4>
                <button class="btn btn-warning btn-sm" id="resetJournalForm">
                  Reset Form
                </button>
              </div>
              <div class="form-group">
                <label class="form-label">Judul Entri</label>
                <input
                  type="text"
                  class="form-input"
                  id="journalTitle"
                  placeholder="Judul entri Anda..."
                />
              </div>
              <div class="form-group">
                <label class="form-label">Konten</label>
                <textarea
                  class="form-input"
                  id="journalContent"
                  placeholder="Tulis pemikiran, ide, atau refleksi Anda..."
                ></textarea>
              </div>
              <div class="form-group">
                <label class="form-label">Kategori</label>
                <select class="form-input" id="journalCategory">
                  <option value="personal">Personal</option>
                  <option value="professional">Profesional</option>
                  <option value="ideas">Ide</option>
                  <option value="reflection">Refleksi</option>
                  <option value="learning">Pembelajaran</option>
                </select>
              </div>
              <div class="flex gap-2">
                <button class="btn btn-primary" id="saveJournal">
                  Simpan Entri
                </button>
                <button class="btn btn-danger" id="resetAllJournal">
                  Reset Semua Jurnal
                </button>
              </div>
            </div>

            <div>
              <div class="flex justify-between items-center mb-4">
                <h4>Entri Terbaru</h4>
                <button class="btn btn-warning btn-sm" id="clearOldJournal">
                  Hapus Lama
                </button>
              </div>
              <div class="list" id="journalList">
                <!-- Journal entries will be populated here -->
              </div>
            </div>
          </div>
        </section>

        <!-- Goals & Milestones -->
        <section class="panel card" id="goals">
          <div class="card-header">
            <h2>Goals & Target</h2>
            <div class="text-body">
              Tetapkan dan lacak tujuan jangka panjang Anda
            </div>
          </div>

          <div class="grid-2">
            <div>
              <div class="flex justify-between items-center mb-4">
                <h4>Goal Baru</h4>
                <button class="btn btn-warning btn-sm" id="resetGoalForm">
                  Reset Form
                </button>
              </div>
              <div class="form-group">
                <label class="form-label">Deskripsi Goal</label>
                <input
                  type="text"
                  class="form-input"
                  id="goalTitle"
                  placeholder="Apa yang ingin Anda capai?"
                />
              </div>
              <div class="form-group">
                <label class="form-label">Tanggal Target</label>
                <input type="date" class="form-input" id="goalDeadline" />
              </div>
              <div class="form-group">
                <label class="form-label">Progress Saat Ini</label>
                <input
                  type="range"
                  class="form-input"
                  id="goalProgress"
                  min="0"
                  max="100"
                  value="0"
                />
                <div class="text-small text-right" id="progressValue">0%</div>
              </div>
              <div class="flex gap-2">
                <button class="btn btn-primary" id="addGoal">
                  Tetapkan Goal
                </button>
                <button class="btn btn-danger" id="resetAllGoals">
                  Reset Semua Goals
                </button>
              </div>
            </div>

            <div>
              <div class="flex justify-between items-center mb-4">
                <h4>Goals Anda</h4>
                <button class="btn btn-warning btn-sm" id="resetProgressGoals">
                  Reset Progress
                </button>
              </div>
              <div class="list" id="goalsList">
                <!-- Goals will be populated here -->
              </div>
            </div>
          </div>
        </section>

        <!-- Financial Management -->
        <section class="panel card" id="finance">
          <div class="card-header">
            <h2>Manajemen Keuangan</h2>
            <div class="text-body">
              Lacak pemasukan, pengeluaran, dan tujuan keuangan
            </div>
          </div>

          <div class="grid-3 mb-6">
            <div class="financial-card">
              <div class="text-small mb-2">Total Pemasukan</div>
              <div class="amount" id="totalIncome">Rp 0</div>
            </div>

            <div class="financial-card">
              <div class="text-small mb-2">Total Pengeluaran</div>
              <div class="amount" id="totalExpense">Rp 0</div>
            </div>

            <div class="financial-card">
              <div class="text-small mb-2">Saldo Bersih</div>
              <div class="amount" id="netBalance">Rp 0</div>
            </div>
          </div>

          <div class="grid-2">
            <div>
              <div class="flex justify-between items-center mb-4">
                <h4>Catat Transaksi</h4>
                <button class="btn btn-warning btn-sm" id="resetTransactionForm">
                  Reset Form
                </button>
              </div>
              <div class="form-group">
                <label class="form-label">Jenis Transaksi</label>
                <select class="form-input" id="transactionType">
                  <option value="income">Pemasukan</option>
                  <option value="expense">Pengeluaran</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Jumlah</label>
                <input
                  type="number"
                  class="form-input"
                  id="transactionAmount"
                  placeholder="0"
                />
              </div>
              <div class="form-group">
                <label class="form-label">Kategori</label>
                <select class="form-input" id="transactionCategory">
                  <option value="salary">Gaji</option>
                  <option value="freelance">Freelance</option>
                  <option value="investment">Investasi</option>
                  <option value="food">Makanan & Restoran</option>
                  <option value="transport">Transportasi</option>
                  <option value="entertainment">Hiburan</option>
                  <option value="shopping">Belanja</option>
                  <option value="bills">Tagihan & Utilitas</option>
                  <option value="other">Lainnya</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Keterangan</label>
                <input
                  type="text"
                  class="form-input"
                  id="transactionNote"
                  placeholder="Deskripsi transaksi..."
                />
              </div>
              <div class="flex gap-2">
                <button class="btn btn-primary" id="addTransaction">
                  Catat Transaksi
                </button>
                <button class="btn btn-danger" id="resetAllTransactions">
                  Reset Semua Transaksi
                </button>
              </div>
            </div>

            <div>
              <div class="flex justify-between items-center mb-4">
                <h4>Riwayat Transaksi</h4>
                <button class="btn btn-warning btn-sm" id="clearOldTransactions">
                  Hapus Lama
                </button>
              </div>
              <div class="list" id="transactionHistory">
                <!-- Transactions will be populated here -->
              </div>
            </div>
          </div>
        </section>

        <!-- Advanced Analytics -->
        <section class="panel card" id="analytics">
          <div class="card-header">
            <h2>Analisis Lanjutan</h2>
            <div class="text-body">
              Wawasan berbasis data dan metrik performa
            </div>
          </div>

          <div class="grid-3 mb-6">
            <div class="card text-center">
              <div class="text-small text-muted mb-2">
                Rata-rata Produktivitas
              </div>
              <div class="amount" id="avgProductivity">0%</div>
            </div>

            <div class="card text-center">
              <div class="text-small text-muted mb-2">
                Penyelesaian Tepat Waktu
              </div>
              <div class="amount" id="onTimeTasks">0%</div>
            </div>

            <div class="card text-center">
              <div class="text-small text-muted mb-2">Konsistensi Harian</div>
              <div class="amount" id="dailyConsistency">0%</div>
            </div>
          </div>

          <div class="grid-2">
            <div class="card">
              <div class="flex justify-between items-center mb-4">
                <h4>Trend Produktivitas</h4>
                <button class="btn btn-warning btn-sm" id="resetAnalytics">
                  Reset Data
                </button>
              </div>
              <div class="text-center py-12 text-muted">
                Chart dan grafik lanjutan akan ditampilkan di sini
              </div>
            </div>

            <div class="card">
              <div class="flex justify-between items-center mb-4">
                <h4>Rekomendasi AI</h4>
                <button class="btn btn-warning btn-sm" id="refreshRecommendations">
                  Refresh
                </button>
              </div>
              <div class="text-body" id="aiRecommendations">
                Menganalisis pola Anda untuk memberikan rekomendasi yang
                dipersonalisasi...
              </div>
            </div>
          </div>
        </section>

        <!-- Integrations -->
        <section class="panel card" id="integrations">
          <div class="card-header">
            <h2>Integrasi</h2>
            <div class="text-body">
              Terhubung dengan platform dan layanan lainnya
            </div>
          </div>

          <div class="grid-2">
            <div class="telegram-integration">
              <h4 class="mb-4">üì± Integrasi Telegram Bot</h4>
              <div class="text-small mb-4">
                Hubungkan akun Telegram Anda untuk mengelola tugas, keuangan,
                dan mendapatkan notifikasi saat bepergian.
              </div>

              <div class="form-group">
                <label class="form-label" style="color: white"
                  >Token Bot Telegram</label
                >
                <input
                  type="password"
                  class="form-input"
                  id="telegramToken"
                  placeholder="Masukkan token bot Anda"
                />
              </div>

              <div class="form-group">
                <label class="form-label" style="color: white">Chat ID</label>
                <input
                  type="text"
                  class="form-input"
                  id="telegramChatId"
                  placeholder="ID chat Anda"
                />
              </div>

              <div class="flex gap-2">
                <button
                  class="btn"
                  style="background: white; color: var(--stone)"
                  id="connectTelegram"
                >
                  Hubungkan Telegram Bot
                </button>
                <button class="btn btn-warning" id="resetTelegramConfig">
                  Reset Konfigurasi
                </button>
              </div>

              <div class="telegram-commands">
                <div class="text-small mb-2" style="color: white">
                  Perintah yang Tersedia:
                </div>
                <div
                  class="text-caption"
                  style="color: rgba(255, 255, 255, 0.8)"
                >
                  /tasks - Lihat tugas tertunda<br />
                  /addtask [deskripsi] - Tambah tugas baru<br />
                  /expense [jumlah] [kategori] - Catat pengeluaran<br />
                  /income [jumlah] [kategori] - Catat pemasukan<br />
                  /balance - Cek saldo saat ini<br />
                  /goals - Lihat progress goals<br />
                  /journal [entri] - Tambah entri jurnal<br />
                </div>
              </div>
            </div>

            <div>
              <div class="flex justify-between items-center mb-4">
                <h4>Integrasi Lainnya</h4>
                <button class="btn btn-warning btn-sm" id="resetIntegrations">
                  Reset Semua
                </button>
              </div>
              <div class="card mb-4">
                <div class="flex items-center justify-between">
                  <div>
                    <div class="text-body font-medium">Google Calendar</div>
                    <div class="text-small text-muted">
                      Sinkronkan tugas dan deadline
                    </div>
                    <div class="integration-status integration-connected" id="calendarStatus">
                      <span>‚óè</span>
                      <span>Terkoneksi</span>
                    </div>
                  </div>
                  <button class="btn btn-secondary btn-sm" id="connectCalendar">
                    Kelola
                  </button>
                </div>
              </div>

              <div class="card mb-4">
                <div class="flex items-center justify-between">
                  <div>
                    <div class="text-body font-medium">Google Spreadsheet</div>
                    <div class="text-small text-muted">
                      Ekspor data ke spreadsheet
                    </div>
                    <div class="integration-status integration-connected" id="spreadsheetStatus">
                      <span>‚óè</span>
                      <span>Terkoneksi</span>
                    </div>
                  </div>
                  <button class="btn btn-secondary btn-sm" id="connectSpreadsheet">
                    Kelola
                  </button>
                </div>
              </div>

              <div class="card">
                <div class="flex items-center justify-between">
                  <div>
                    <div class="text-body font-medium">Gmail</div>
                    <div class="text-small text-muted">
                      Buat tugas dari email
                    </div>
                    <div class="integration-status integration-connected" id="gmailStatus">
                      <span>‚óè</span>
                      <span>Terkoneksi</span>
                    </div>
                  </div>
                  <button class="btn btn-secondary btn-sm" id="connectGmail">
                    Kelola
                  </button>
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <!-- Advanced Voice Assistant -->
    <div class="voice-assistant">
      <button class="voice-btn" id="voiceButton" title="Asisten AI Suara">
        üé§
      </button>
      <div class="voice-panel" id="voicePanel">
        <div class="voice-transcript" id="voiceTranscript">
          Klik tombol mikrofon dan mulai berbicara...
        </div>
        <div class="voice-response" id="voiceResponse">
          Halo! Saya asisten AI Anda. Saya bisa membantu mengelola tugas,
          keuangan, goals, dan lainnya. Coba katakan: "Tambah tugas
          menyelesaikan laporan kuartal sampai Jumat" atau "Catat pengeluaran Rp
          50.000 untuk makan siang"
        </div>
      </div>
    </div>

    <!-- Telegram Bot Setup Modal -->
    <div
      class="modal"
      id="telegramModal"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(42, 49, 50, 0.5);
        z-index: 2000;
        align-items: center;
        justify-content: center;
        padding: 20px;
      "
    >
      <div class="card" style="max-width: 500px; width: 100%;">
        <h3 class="mb-4">Setup Telegram Bot</h3>
        <div class="text-body mb-4">
          Untuk menggunakan integrasi Telegram Bot, Anda perlu membuat bot dan
          mendapatkan kredensial Anda.
        </div>

        <div class="form-group">
          <label class="form-label">Token Bot</label>
          <input
            type="password"
            class="form-input"
            id="botToken"
            placeholder="123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11"
          />
        </div>

        <div class="form-group">
          <label class="form-label">Chat ID</label>
          <input
            type="text"
            class="form-input"
            id="chatId"
            placeholder="123456789"
          />
        </div>

        <div class="flex gap-2 flex-wrap">
          <button class="btn btn-primary" id="saveTelegramConfig">
            Simpan Konfigurasi
          </button>
          <button class="btn btn-secondary" id="closeTelegramModal">
            Batal
          </button>
        </div>
      </div>
    </div>

    <!-- Reset Confirmation Modal -->
    <div
      class="modal"
      id="resetModal"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(42, 49, 50, 0.5);
        z-index: 2000;
        align-items: center;
        justify-content: center;
        padding: 20px;
      "
    >
      <div class="card" style="max-width: 400px; width: 100%;">
        <h3 class="mb-4" id="resetModalTitle">Konfirmasi Reset</h3>
        <div class="text-body mb-4" id="resetModalMessage">
          Apakah Anda yakin ingin mereset data ini? Tindakan ini tidak dapat dibatalkan.
        </div>
        <div class="flex gap-2 flex-wrap">
          <button class="btn btn-danger" id="confirmReset">
            Ya, Reset
          </button>
          <button class="btn btn-secondary" id="cancelReset">
            Batal
          </button>
        </div>
      </div>
    </div>

    <script>
      // ===== UTILITY FUNCTIONS =====
      const $ = (selector) => document.querySelector(selector);
      const $$ = (selector) => Array.from(document.querySelectorAll(selector));

      // ===== SECURITY UTILITIES =====
      class SecurityUtils {
        static sanitizeHTML(input) {
          if (typeof input !== "string") return "";
          const div = document.createElement("div");
          div.textContent = input;
          return div.innerHTML;
        }

        static validateEmail(email) {
          return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        static encryptData(data, key) {
          // Simple encryption for demo - in production use Web Crypto API
          try {
            return btoa(JSON.stringify(data));
          } catch {
            return data;
          }
        }

        static decryptData(encryptedData, key) {
          try {
            return JSON.parse(atob(encryptedData));
          } catch {
            return encryptedData;
          }
        }
      }

      // ===== TOAST NOTIFICATION SYSTEM =====
      class ToastNotification {
        static show(message, type = "info", duration = 5000) {
          const container = $("#toastContainer");
          const toast = document.createElement("div");
          toast.className = `toast toast-${type}`;

          const icons = {
            success: "‚úÖ",
            error: "‚ùå",
            warning: "‚ö†Ô∏è",
            info: "‚ÑπÔ∏è",
          };

          toast.innerHTML = `
                    <div class="flex items-center gap-3 w-full">
                        <span class="text-lg">${icons[type] || "‚ÑπÔ∏è"}</span>
                        <span class="flex-1">${SecurityUtils.sanitizeHTML(
                          message
                        )}</span>
                        <button class="btn btn-icon btn-sm" onclick="this.parentElement.parentElement.remove()">
                            &times;
                        </button>
                    </div>
                `;

          container.appendChild(toast);

          // Auto remove after duration
          setTimeout(() => {
            if (toast.parentElement) {
              toast.remove();
            }
          }, duration);

          return toast;
        }
      }

      // ===== ERROR HANDLER =====
      class ErrorHandler {
        static handle(error, context) {
          console.error(`[${context}]`, error);
          ToastNotification.show(`Operasi gagal: ${error.message}`, "error");

          // Log to analytics if available
          this.logToAnalytics(error, context);
        }

        static logToAnalytics(error, context) {
          // Integrate with analytics service here
          if (typeof gtag !== "undefined") {
            gtag("event", "exception", {
              description: `${context}: ${error.message}`,
              fatal: false,
            });
          }
        }
      }

      // ===== PERFORMANCE UTILITIES =====
      class PerformanceUtils {
        static debounce(func, wait) {
          let timeout;
          return function executedFunction(...args) {
            const later = () => {
              clearTimeout(timeout);
              func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
          };
        }
      }

      // ===== ENTERPRISE GANESA HUB IMPLEMENTATION =====
      class GanesaHubEnterprise {
        constructor() {
          this.state = this.loadState();
          this.voiceAssistant = new AdvancedVoiceAssistant(this);
          this.telegramBot = new TelegramBotIntegration(this);
          this.resetContext = null; // Untuk menyimpan konteks reset
          this.init();
        }

        loadState() {
          const defaultState = {
            tasks: [],
            journalEntries: [],
            goals: [],
            transactions: [],
            settings: {
              theme: "auto",
              voiceEnabled: true,
              telegramConfig: null,
              integrations: {
                googleCalendar: { connected: true, lastSync: new Date().toISOString() },
                googleSpreadsheet: { connected: true, lastSync: new Date().toISOString() },
                gmail: { connected: true, lastSync: new Date().toISOString() }
              }
            },
            dailyFocus: "",
            quickNote: "",
            balance: 0,
          };

          try {
            const saved = localStorage.getItem(
              "ganesa_hub_enterprise_encrypted"
            );
            if (saved) {
              const decrypted = SecurityUtils.decryptData(saved, "ganesa_key");
              return saved ? { ...defaultState, ...decrypted } : defaultState;
            }
            return defaultState;
          } catch (error) {
            ErrorHandler.handle(error, "loadState");
            return defaultState;
          }
        }

        saveState() {
          try {
            const encrypted = SecurityUtils.encryptData(
              this.state,
              "ganesa_key"
            );
            localStorage.setItem("ganesa_hub_enterprise_encrypted", encrypted);
          } catch (error) {
            ErrorHandler.handle(error, "saveState");
          }
        }

        init() {
          this.initTheme();
          this.initDateTime();
          this.initEventListeners();
          this.renderAll();
          ToastNotification.show("Sistem berhasil diinisialisasi", "success");
        }

        initTheme() {
          const theme = this.state.settings.theme;
          if (theme === "auto") {
            const prefersDark = window.matchMedia(
              "(prefers-color-scheme: dark)"
            ).matches;
            document.documentElement.setAttribute(
              "data-theme",
              prefersDark ? "dark" : "light"
            );
          } else {
            document.documentElement.setAttribute("data-theme", theme);
          }
        }

        initDateTime() {
          const updateDateTime = () => {
            const now = new Date();
            const options = {
              weekday: "long",
              year: "numeric",
              month: "long",
              day: "numeric",
              hour: "2-digit",
              minute: "2-digit",
            };
            $("#currentDateTime").textContent = now.toLocaleDateString(
              "id-ID",
              options
            );

            const hour = now.getHours();
            let greeting = "Selamat malam";
            if (hour < 12) greeting = "Selamat pagi";
            else if (hour < 18) greeting = "Selamat siang";

            $("#greetingText").textContent = greeting;
          };

          updateDateTime();
          setInterval(updateDateTime, 60000);
        }

        initEventListeners() {
          try {
            // Mobile menu
            $("#mobileMenuBtn").addEventListener("click", () => {
              $("#sidebar").classList.toggle("active");
            });

            // Navigation
            $$(".nav-item").forEach((item) => {
              item.addEventListener("click", () => {
                this.switchPanel(item.dataset.panel);
                // Close mobile menu after selection
                if (window.innerWidth <= 1024) {
                  $("#sidebar").classList.remove("active");
                }
              });
            });

            // Theme toggle
            $("#themeToggle").addEventListener("click", () =>
              this.toggleTheme()
            );

            // Dashboard
            $("#saveFocus").addEventListener("click", () =>
              this.saveDailyFocus()
            );
            $("#clearFocus").addEventListener("click", () =>
              this.clearDailyFocus()
            );
            $("#saveNote").addEventListener("click", () =>
              this.saveQuickNote()
            );
            $("#resetFocus").addEventListener("click", () =>
              this.showResetModal("focus", "Reset fokus harian?")
            );
            $("#resetNote").addEventListener("click", () =>
              this.showResetModal("note", "Reset catatan cepat?")
            );

            // Tasks
            $("#addTask").addEventListener("click", () => this.addTask());
            $("#taskInput").addEventListener("keypress", (e) => {
              if (e.key === "Enter") this.addTask();
            });
            $("#resetTaskForm").addEventListener("click", () =>
              this.resetTaskForm()
            );
            $("#resetAllTasks").addEventListener("click", () =>
              this.showResetModal("allTasks", "Reset semua tugas?")
            );
            $("#clearCompletedTasks").addEventListener("click", () =>
              this.showResetModal("completedTasks", "Hapus semua tugas yang sudah selesai?")
            );

            // Journal
            $("#saveJournal").addEventListener("click", () =>
              this.saveJournalEntry()
            );
            $("#resetJournalForm").addEventListener("click", () =>
              this.resetJournalForm()
            );
            $("#resetAllJournal").addEventListener("click", () =>
              this.showResetModal("allJournal", "Reset semua entri jurnal?")
            );
            $("#clearOldJournal").addEventListener("click", () =>
              this.showResetModal("oldJournal", "Hapus entri jurnal lama?")
            );

            // Goals
            $("#addGoal").addEventListener("click", () => this.addGoal());
            $("#goalProgress").addEventListener("input", (e) => {
              $("#progressValue").textContent = `${e.target.value}%`;
            });
            $("#resetGoalForm").addEventListener("click", () =>
              this.resetGoalForm()
            );
            $("#resetAllGoals").addEventListener("click", () =>
              this.showResetModal("allGoals", "Reset semua goals?")
            );
            $("#resetProgressGoals").addEventListener("click", () =>
              this.showResetModal("progressGoals", "Reset progress semua goals ke 0%?")
            );

            // Finance
            $("#addTransaction").addEventListener("click", () =>
              this.addTransaction()
            );
            $("#resetTransactionForm").addEventListener("click", () =>
              this.resetTransactionForm()
            );
            $("#resetAllTransactions").addEventListener("click", () =>
              this.showResetModal("allTransactions", "Reset semua transaksi?")
            );
            $("#clearOldTransactions").addEventListener("click", () =>
              this.showResetModal("oldTransactions", "Hapus transaksi lama?")
            );

            // Analytics
            $("#resetAnalytics").addEventListener("click", () =>
              this.showResetModal("analytics", "Reset data analitik?")
            );
            $("#refreshRecommendations").addEventListener("click", () =>
              this.refreshRecommendations()
            );

            // Integrations
            $("#telegramSetup").addEventListener("click", () =>
              this.showTelegramModal()
            );
            $("#connectTelegram").addEventListener("click", () =>
              this.connectTelegramBot()
            );
            $("#saveTelegramConfig").addEventListener("click", () =>
              this.saveTelegramConfig()
            );
            $("#closeTelegramModal").addEventListener("click", () =>
              this.hideTelegramModal()
            );
            $("#resetTelegramConfig").addEventListener("click", () =>
              this.showResetModal("telegramConfig", "Reset konfigurasi Telegram?")
            );
            $("#resetIntegrations").addEventListener("click", () =>
              this.showResetModal("allIntegrations", "Reset semua integrasi?")
            );

            // Google Integrations
            $("#connectCalendar").addEventListener("click", () =>
              this.toggleGoogleIntegration('googleCalendar')
            );
            $("#connectSpreadsheet").addEventListener("click", () =>
              this.toggleGoogleIntegration('googleSpreadsheet')
            );
            $("#connectGmail").addEventListener("click", () =>
              this.toggleGoogleIntegration('gmail')
            );

            // Voice assistant
            $("#voiceButton").addEventListener("click", () =>
              this.voiceAssistant.toggle()
            );

            // Reset modal
            $("#confirmReset").addEventListener("click", () =>
              this.executeReset()
            );
            $("#cancelReset").addEventListener("click", () =>
              this.hideResetModal()
            );

            // Debounced auto-save
            $("#quickNote").addEventListener(
              "input",
              PerformanceUtils.debounce(() => this.saveQuickNote(), 1000)
            );

            // Close modals when clicking outside
            document.addEventListener('click', (e) => {
              if (e.target.id === 'telegramModal') {
                this.hideTelegramModal();
              }
              if (e.target.id === 'resetModal') {
                this.hideResetModal();
              }
            });

          } catch (error) {
            ErrorHandler.handle(error, "initEventListeners");
          }
        }

        // ===== GOOGLE INTEGRATIONS =====
        toggleGoogleIntegration(service) {
          const integration = this.state.settings.integrations[service];
          integration.connected = !integration.connected;
          integration.lastSync = new Date().toISOString();
          
          this.saveState();
          this.renderIntegrations();
          
          const serviceNames = {
            googleCalendar: 'Google Calendar',
            googleSpreadsheet: 'Google Spreadsheet',
            gmail: 'Gmail'
          };
          
          ToastNotification.show(
            `${serviceNames[service]} ${integration.connected ? 'terhubung' : 'terputus'}`,
            integration.connected ? 'success' : 'warning'
          );
        }

        // ===== RESET FUNCTIONALITIES =====
        showResetModal(context, message) {
          this.resetContext = context;
          $("#resetModalTitle").textContent = "Konfirmasi Reset";
          $("#resetModalMessage").textContent = message;
          $("#resetModal").style.display = "flex";
        }

        hideResetModal() {
          $("#resetModal").style.display = "none";
          this.resetContext = null;
        }

        executeReset() {
          if (!this.resetContext) return;

          try {
            switch (this.resetContext) {
              case "focus":
                this.clearDailyFocus();
                break;
              case "note":
                this.state.quickNote = "";
                $("#quickNote").value = "";
                this.saveState();
                ToastNotification.show("Catatan cepat direset", "success");
                break;
              case "allTasks":
                this.state.tasks = [];
                this.saveState();
                this.renderTasks();
                this.renderDashboard();
                ToastNotification.show("Semua tugas direset", "success");
                break;
              case "completedTasks":
                this.state.tasks = this.state.tasks.filter(t => !t.completed);
                this.saveState();
                this.renderTasks();
                this.renderDashboard();
                ToastNotification.show("Tugas selesai dihapus", "success");
                break;
              case "allJournal":
                this.state.journalEntries = [];
                this.saveState();
                this.renderJournal();
                ToastNotification.show("Semua jurnal direset", "success");
                break;
              case "oldJournal":
                // Hapus entri lebih dari 30 hari
                const thirtyDaysAgo = new Date();
                thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
                this.state.journalEntries = this.state.journalEntries.filter(
                  entry => new Date(entry.createdAt) > thirtyDaysAgo
                );
                this.saveState();
                this.renderJournal();
                ToastNotification.show("Jurnal lama dihapus", "success");
                break;
              case "allGoals":
                this.state.goals = [];
                this.saveState();
                this.renderGoals();
                this.renderDashboard();
                ToastNotification.show("Semua goals direset", "success");
                break;
              case "progressGoals":
                this.state.goals.forEach(goal => {
                  goal.progress = 0;
                });
                this.saveState();
                this.renderGoals();
                ToastNotification.show("Progress goals direset", "success");
                break;
              case "allTransactions":
                this.state.transactions = [];
                this.state.balance = 0;
                this.saveState();
                this.renderFinance();
                ToastNotification.show("Semua transaksi direset", "success");
                break;
              case "oldTransactions":
                // Hapus transaksi lebih dari 90 hari
                const ninetyDaysAgo = new Date();
                ninetyDaysAgo.setDate(ninetyDaysAgo.getDate() - 90);
                this.state.transactions = this.state.transactions.filter(
                  transaction => new Date(transaction.date) > ninetyDaysAgo
                );
                // Recalculate balance
                this.state.balance = this.state.transactions.reduce((total, t) => {
                  return t.type === "income" ? total + t.amount : total - t.amount;
                }, 0);
                this.saveState();
                this.renderFinance();
                ToastNotification.show("Transaksi lama dihapus", "success");
                break;
              case "analytics":
                // Reset analytics data
                ToastNotification.show("Data analitik direset", "success");
                break;
              case "telegramConfig":
                this.state.settings.telegramConfig = null;
                $("#telegramToken").value = "";
                $("#telegramChatId").value = "";
                this.saveState();
                ToastNotification.show("Konfigurasi Telegram direset", "success");
                break;
              case "allIntegrations":
                Object.keys(this.state.settings.integrations).forEach(key => {
                  this.state.settings.integrations[key].connected = false;
                });
                this.state.settings.telegramConfig = null;
                this.saveState();
                this.renderIntegrations();
                ToastNotification.show("Semua integrasi direset", "success");
                break;
            }
          } catch (error) {
            ErrorHandler.handle(error, `reset-${this.resetContext}`);
          }

          this.hideResetModal();
        }

        resetTaskForm() {
          $("#taskInput").value = "";
          $("#taskPriority").value = "medium";
          $("#taskDeadline").value = "";
          ToastNotification.show("Form tugas direset", "success");
        }

        resetJournalForm() {
          $("#journalTitle").value = "";
          $("#journalContent").value = "";
          $("#journalCategory").value = "personal";
          ToastNotification.show("Form jurnal direset", "success");
        }

        resetGoalForm() {
          $("#goalTitle").value = "";
          $("#goalDeadline").value = "";
          $("#goalProgress").value = "0";
          $("#progressValue").textContent = "0%";
          ToastNotification.show("Form goal direset", "success");
        }

        resetTransactionForm() {
          $("#transactionType").value = "income";
          $("#transactionAmount").value = "";
          $("#transactionCategory").value = "salary";
          $("#transactionNote").value = "";
          ToastNotification.show("Form transaksi direset", "success");
        }

        refreshRecommendations() {
          // Generate new AI recommendations
          const recommendations = [
            "Coba fokus pada 3 tugas prioritas tinggi hari ini untuk meningkatkan produktivitas.",
            "Pertimbangkan untuk mengalokasikan waktu khusus untuk tugas-tugas yang membutuhkan konsentrasi tinggi.",
            "Tinjau kembali goals jangka panjang Anda dan sesuaikan progress jika diperlukan.",
            "Evaluasi pengeluaran bulanan Anda dan identifikasi area yang dapat dioptimalkan.",
            "Jadwalkan waktu untuk refleksi mingguan untuk mengevaluasi progress dan menyesuaikan rencana."
          ];
          
          const randomRecommendation = recommendations[Math.floor(Math.random() * recommendations.length)];
          $("#aiRecommendations").textContent = randomRecommendation;
          ToastNotification.show("Rekomendasi AI diperbarui", "success");
        }

        // ===== EXISTING METHODS =====
        switchPanel(panelId) {
          $$(".nav-item").forEach((item) => {
            item.classList.toggle("active", item.dataset.panel === panelId);
          });

          $$(".panel").forEach((panel) => {
            panel.classList.toggle("active", panel.id === panelId);
          });
        }

        toggleTheme() {
          try {
            const current = document.documentElement.getAttribute("data-theme");
            const newTheme = current === "dark" ? "light" : "dark";
            document.documentElement.setAttribute("data-theme", newTheme);
            this.state.settings.theme = newTheme;
            this.saveState();
          } catch (error) {
            ErrorHandler.handle(error, "toggleTheme");
          }
        }

        // Task Management
        addTask() {
          try {
            const text = SecurityUtils.sanitizeHTML(
              $("#taskInput").value.trim()
            );
            if (!text) {
              ToastNotification.show("Masukkan deskripsi tugas", "error");
              return;
            }

            const task = {
              id: Date.now(),
              text: text,
              priority: $("#taskPriority").value,
              deadline: $("#taskDeadline").value,
              completed: false,
              createdAt: new Date().toISOString(),
            };

            this.state.tasks.unshift(task);
            $("#taskInput").value = "";
            $("#taskDeadline").value = "";
            this.saveState();
            this.renderTasks();
            ToastNotification.show("Tugas berhasil ditambahkan", "success");

            // Notify Telegram bot
            this.telegramBot.notifyNewTask(task);
          } catch (error) {
            ErrorHandler.handle(error, "addTask");
          }
        }

        toggleTask(taskId) {
          try {
            const task = this.state.tasks.find((t) => t.id === taskId);
            if (task) {
              task.completed = !task.completed;
              task.completedAt = task.completed
                ? new Date().toISOString()
                : null;
              this.saveState();
              this.renderTasks();
              this.renderDashboard();
            }
          } catch (error) {
            ErrorHandler.handle(error, "toggleTask");
          }
        }

        deleteTask(taskId) {
          try {
            this.state.tasks = this.state.tasks.filter((t) => t.id !== taskId);
            this.saveState();
            this.renderTasks();
            this.renderDashboard();
            ToastNotification.show("Tugas berhasil dihapus", "success");
          } catch (error) {
            ErrorHandler.handle(error, "deleteTask");
          }
        }

        // Journal Management
        saveJournalEntry() {
          try {
            const title = SecurityUtils.sanitizeHTML(
              $("#journalTitle").value.trim()
            );
            const content = SecurityUtils.sanitizeHTML(
              $("#journalContent").value.trim()
            );

            if (!content) {
              ToastNotification.show("Masukkan konten jurnal", "error");
              return;
            }

            const entry = {
              id: Date.now(),
              title: title || `Entri ${new Date().toLocaleDateString("id-ID")}`,
              content: content,
              category: $("#journalCategory").value,
              createdAt: new Date().toISOString(),
            };

            this.state.journalEntries.unshift(entry);
            $("#journalTitle").value = "";
            $("#journalContent").value = "";
            this.saveState();
            this.renderJournal();
            ToastNotification.show("Entri jurnal disimpan", "success");
          } catch (error) {
            ErrorHandler.handle(error, "saveJournalEntry");
          }
        }

        // Goals Management
        addGoal() {
          try {
            const title = SecurityUtils.sanitizeHTML(
              $("#goalTitle").value.trim()
            );
            if (!title) {
              ToastNotification.show("Masukkan deskripsi goal", "error");
              return;
            }

            const goal = {
              id: Date.now(),
              title: title,
              deadline: $("#goalDeadline").value,
              progress: parseInt($("#goalProgress").value),
              createdAt: new Date().toISOString(),
            };

            this.state.goals.unshift(goal);
            $("#goalTitle").value = "";
            $("#goalDeadline").value = "";
            $("#goalProgress").value = "0";
            $("#progressValue").textContent = "0%";
            this.saveState();
            this.renderGoals();
            ToastNotification.show("Goal berhasil ditetapkan", "success");
          } catch (error) {
            ErrorHandler.handle(error, "addGoal");
          }
        }

        updateGoalProgress(goalId, progress) {
          try {
            const goal = this.state.goals.find((g) => g.id === goalId);
            if (goal) {
              goal.progress = progress;
              this.saveState();
              this.renderGoals();

              if (progress === 100) {
                ToastNotification.show("Goal tercapai! üéâ", "success");
                this.telegramBot.notifyGoalCompleted(goal);
              }
            }
          } catch (error) {
            ErrorHandler.handle(error, "updateGoalProgress");
          }
        }

        // Finance Management
        addTransaction() {
          try {
            const amount = parseFloat($("#transactionAmount").value);
            const type = $("#transactionType").value;
            const category = $("#transactionCategory").value;
            const note = SecurityUtils.sanitizeHTML(
              $("#transactionNote").value.trim()
            );

            if (!amount || amount <= 0) {
              ToastNotification.show("Masukkan jumlah yang valid", "error");
              return;
            }

            const transaction = {
              id: Date.now(),
              type: type,
              amount: amount,
              category: category,
              note:
                note ||
                `${
                  type === "income" ? "Pemasukan" : "Pengeluaran"
                } - ${category}`,
              date: new Date().toISOString(),
            };

            this.state.transactions.unshift(transaction);

            // Update balance
            if (type === "income") {
              this.state.balance += amount;
            } else {
              this.state.balance -= amount;
            }

            $("#transactionAmount").value = "";
            $("#transactionNote").value = "";
            this.saveState();
            this.renderFinance();
            ToastNotification.show("Transaksi dicatat", "success");

            // Notify Telegram bot
            this.telegramBot.notifyTransaction(transaction);
          } catch (error) {
            ErrorHandler.handle(error, "addTransaction");
          }
        }

        // Dashboard
        saveDailyFocus() {
          try {
            this.state.dailyFocus = SecurityUtils.sanitizeHTML(
              $("#dailyFocus").value
            );
            this.saveState();
            ToastNotification.show("Fokus harian disimpan", "success");
          } catch (error) {
            ErrorHandler.handle(error, "saveDailyFocus");
          }
        }

        clearDailyFocus() {
          try {
            this.state.dailyFocus = "";
            $("#dailyFocus").value = "";
            this.saveState();
            ToastNotification.show("Fokus harian dihapus", "success");
          } catch (error) {
            ErrorHandler.handle(error, "clearDailyFocus");
          }
        }

        saveQuickNote() {
          try {
            this.state.quickNote = SecurityUtils.sanitizeHTML(
              $("#quickNote").value
            );
            this.saveState();
            ToastNotification.show("Catatan disimpan", "success");
          } catch (error) {
            ErrorHandler.handle(error, "saveQuickNote");
          }
        }

        // Telegram Integration
        showTelegramModal() {
          $("#telegramModal").style.display = "flex";
        }

        hideTelegramModal() {
          $("#telegramModal").style.display = "none";
        }

        connectTelegramBot() {
          try {
            const token = $("#telegramToken").value.trim();
            const chatId = $("#telegramChatId").value.trim();

            if (!token || !chatId) {
              ToastNotification.show("Masukkan token dan chat ID", "error");
              return;
            }

            this.state.settings.telegramConfig = { token, chatId };
            this.saveState();
            ToastNotification.show(
              "Telegram bot berhasil terhubung",
              "success"
            );
            this.hideTelegramModal();
          } catch (error) {
            ErrorHandler.handle(error, "connectTelegramBot");
          }
        }

        saveTelegramConfig() {
          try {
            const token = $("#botToken").value.trim();
            const chatId = $("#chatId").value.trim();

            if (!token || !chatId) {
              ToastNotification.show("Masukkan token dan chat ID", "error");
              return;
            }

            this.state.settings.telegramConfig = { token, chatId };
            this.saveState();
            ToastNotification.show("Konfigurasi Telegram disimpan", "success");
            this.hideTelegramModal();
          } catch (error) {
            ErrorHandler.handle(error, "saveTelegramConfig");
          }
        }

        // Rendering Methods
        renderAll() {
          this.renderDashboard();
          this.renderTasks();
          this.renderJournal();
          this.renderGoals();
          this.renderFinance();
          this.renderAnalytics();
          this.renderIntegrations();
        }

        renderDashboard() {
          try {
            // Productivity score
            const totalTasks = this.state.tasks.length;
            const completedTasks = this.state.tasks.filter(
              (t) => t.completed
            ).length;
            const productivity =
              totalTasks > 0
                ? Math.round((completedTasks / totalTasks) * 100)
                : 0;

            $("#productivityScore").textContent = `${productivity}%`;
            $("#productivityBar").style.width = `${productivity}%`;
            $("#completedTasks").textContent = completedTasks;
            $("#totalTasks").textContent = totalTasks;

            // Goals progress
            const totalGoals = this.state.goals.length;
            const completedGoals = this.state.goals.filter(
              (g) => g.progress === 100
            ).length;
            const goalsProgress =
              totalGoals > 0
                ? Math.round((completedGoals / totalGoals) * 100)
                : 0;
            $("#goalsProgress").textContent = `${goalsProgress}%`;
            $("#completedGoals").textContent = completedGoals;

            // Finance
            $("#currentBalance").textContent = this.formatCurrency(
              this.state.balance
            );
            $("#dailyFocus").value = this.state.dailyFocus || "";
            $("#quickNote").value = this.state.quickNote || "";
          } catch (error) {
            ErrorHandler.handle(error, "renderDashboard");
          }
        }

        renderTasks() {
          try {
            const container = $("#taskList");
            container.innerHTML = "";

            if (this.state.tasks.length === 0) {
              container.innerHTML =
                '<div class="text-center text-muted py-8">Belum ada tugas. Tambahkan tugas pertama Anda.</div>';
              $("#taskStats").textContent = "0 tugas";
              return;
            }

            $("#taskStats").textContent = `${this.state.tasks.length} tugas`;

            this.state.tasks.forEach((task) => {
              const item = document.createElement("div");
              item.className = "list-item";
              item.innerHTML = `
                            <div class="flex items-center gap-4 w-full">
                                <input type="checkbox" ${
                                  task.completed ? "checked" : ""
                                } 
                                       onchange="ganesaHub.toggleTask(${
                                         task.id
                                       })">
                                <div class="flex-1 ${
                                  task.completed ? "text-muted" : ""
                                }">
                                    <div class="text-body">${task.text}</div>
                                    <div class="text-caption">${this.formatDate(
                                      task.createdAt
                                    )} ‚Ä¢ ${this.getPriorityLabel(
                task.priority
              )}${
                task.deadline
                  ? ` ‚Ä¢ Jatuh tempo: ${this.formatDate(task.deadline)}`
                  : ""
              }</div>
                                </div>
                                <button class="btn btn-secondary btn-sm" onclick="ganesaHub.deleteTask(${
                                  task.id
                                })">
                                    Hapus
                                </button>
                            </div>
                        `;
              container.appendChild(item);
            });
          } catch (error) {
            ErrorHandler.handle(error, "renderTasks");
          }
        }

        renderJournal() {
          try {
            const container = $("#journalList");
            container.innerHTML = "";

            if (this.state.journalEntries.length === 0) {
              container.innerHTML =
                '<div class="text-center text-muted py-8">Belum ada entri jurnal. Mulai tulis pemikiran Anda.</div>';
              return;
            }

            this.state.journalEntries.slice(0, 5).forEach((entry) => {
              const item = document.createElement("div");
              item.className = "list-item";
              item.innerHTML = `
                            <div class="w-full">
                                <div class="text-body font-medium">${
                                  entry.title
                                }</div>
                                <div class="text-caption">${this.formatDate(
                                  entry.createdAt
                                )} ‚Ä¢ ${this.getCategoryLabel(
                entry.category
              )}</div>
                                <div class="text-small text-muted mt-2">${entry.content.substring(
                                  0,
                                  100
                                )}${
                entry.content.length > 100 ? "..." : ""
              }</div>
                            </div>
                        `;
              container.appendChild(item);
            });
          } catch (error) {
            ErrorHandler.handle(error, "renderJournal");
          }
        }

        renderGoals() {
          try {
            const container = $("#goalsList");
            container.innerHTML = "";

            if (this.state.goals.length === 0) {
              container.innerHTML =
                '<div class="text-center text-muted py-8">Belum ada goals. Tetapkan goal pertama Anda.</div>';
              return;
            }

            this.state.goals.forEach((goal) => {
              const item = document.createElement("div");
              item.className = "list-item";
              item.innerHTML = `
                            <div class="w-full">
                                <div class="flex justify-between items-center mb-2">
                                    <div class="text-body font-medium">${
                                      goal.title
                                    }</div>
                                    <div class="text-small">${
                                      goal.progress
                                    }%</div>
                                </div>
                                <div class="progress-bar mb-2">
                                    <div class="progress-fill" style="width: ${
                                      goal.progress
                                    }%"></div>
                                </div>
                                <div class="flex justify-between text-caption text-muted">
                                    <span>${
                                      goal.deadline
                                        ? `Target: ${this.formatDate(
                                            goal.deadline
                                          )}`
                                        : "Tidak ada deadline"
                                    }</span>
                                    <div class="flex gap-2">
                                        <button class="btn btn-secondary btn-sm" onclick="ganesaHub.updateGoalProgress(${
                                          goal.id
                                        }, ${Math.min(
                100,
                goal.progress + 10
              )})">
                                            +10%
                                        </button>
                                        <button class="btn btn-secondary btn-sm" onclick="ganesaHub.updateGoalProgress(${
                                          goal.id
                                        }, ${Math.min(
                100,
                goal.progress + 25
              )})">
                                            +25%
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;
              container.appendChild(item);
            });
          } catch (error) {
            ErrorHandler.handle(error, "renderGoals");
          }
        }

        renderFinance() {
          try {
            // Update summary cards
            const income = this.state.transactions
              .filter((t) => t.type === "income")
              .reduce((sum, t) => sum + t.amount, 0);

            const expense = this.state.transactions
              .filter((t) => t.type === "expense")
              .reduce((sum, t) => sum + t.amount, 0);

            $("#totalIncome").textContent = this.formatCurrency(income);
            $("#totalExpense").textContent = this.formatCurrency(expense);
            $("#netBalance").textContent = this.formatCurrency(
              this.state.balance
            );

            // Render transaction history
            const container = $("#transactionHistory");
            container.innerHTML = "";

            if (this.state.transactions.length === 0) {
              container.innerHTML =
                '<div class="text-center text-muted py-8">Belum ada transaksi. Catat transaksi pertama Anda.</div>';
              return;
            }

            this.state.transactions.slice(0, 10).forEach((transaction) => {
              const item = document.createElement("div");
              item.className = "list-item";
              item.innerHTML = `
                            <div class="w-full">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <div class="text-body">${
                                          transaction.note
                                        }</div>
                                        <div class="text-caption">${this.formatDate(
                                          transaction.date
                                        )} ‚Ä¢ ${this.getCategoryLabel(
                transaction.category
              )}</div>
                                    </div>
                                    <div class="text-body font-medium ${
                                      transaction.type === "income"
                                        ? "text-green-600"
                                        : "text-red-600"
                                    }">
                                        ${
                                          transaction.type === "income"
                                            ? "+"
                                            : "-"
                                        }${this.formatCurrency(
                transaction.amount
              )}
                                    </div>
                                </div>
                            </div>
                        `;
              container.appendChild(item);
            });
          } catch (error) {
            ErrorHandler.handle(error, "renderFinance");
          }
        }

        renderAnalytics() {
          try {
            // Calculate analytics
            const totalTasks = this.state.tasks.length;
            const completedTasks = this.state.tasks.filter(
              (t) => t.completed
            ).length;
            const productivity =
              totalTasks > 0
                ? Math.round((completedTasks / totalTasks) * 100)
                : 0;

            $("#avgProductivity").textContent = `${productivity}%`;
            $("#onTimeTasks").textContent = "85%"; // Placeholder
            $("#dailyConsistency").textContent = "72%"; // Placeholder
          } catch (error) {
            ErrorHandler.handle(error, "renderAnalytics");
          }
        }

        renderIntegrations() {
          try {
            // Update integration status
            const integrations = this.state.settings.integrations;
            
            $("#calendarStatus").className = `integration-status ${
              integrations.googleCalendar.connected ? 'integration-connected' : 'integration-disconnected'
            }`;
            $("#calendarStatus").innerHTML = `<span>‚óè</span><span>${
              integrations.googleCalendar.connected ? 'Terkoneksi' : 'Terputus'
            }</span>`;
            
            $("#spreadsheetStatus").className = `integration-status ${
              integrations.googleSpreadsheet.connected ? 'integration-connected' : 'integration-disconnected'
            }`;
            $("#spreadsheetStatus").innerHTML = `<span>‚óè</span><span>${
              integrations.googleSpreadsheet.connected ? 'Terkoneksi' : 'Terputus'
            }</span>`;
            
            $("#gmailStatus").className = `integration-status ${
              integrations.gmail.connected ? 'integration-connected' : 'integration-disconnected'
            }`;
            $("#gmailStatus").innerHTML = `<span>‚óè</span><span>${
              integrations.gmail.connected ? 'Terkoneksi' : 'Terputus'
            }</span>`;
            
            // Update integration buttons
            $("#connectCalendar").textContent = integrations.googleCalendar.connected ? 'Kelola' : 'Hubungkan';
            $("#connectSpreadsheet").textContent = integrations.googleSpreadsheet.connected ? 'Kelola' : 'Hubungkan';
            $("#connectGmail").textContent = integrations.gmail.connected ? 'Kelola' : 'Hubungkan';
          } catch (error) {
            ErrorHandler.handle(error, "renderIntegrations");
          }
        }

        // Utility Methods
        formatDate(dateString) {
          try {
            return new Date(dateString).toLocaleDateString("id-ID", {
              day: "numeric",
              month: "short",
              year: "numeric",
            });
          } catch {
            return dateString;
          }
        }

        formatCurrency(amount) {
          return new Intl.NumberFormat("id-ID", {
            style: "currency",
            currency: "IDR",
            minimumFractionDigits: 0,
          }).format(amount);
        }

        getPriorityLabel(priority) {
          const labels = {
            low: "Rendah",
            medium: "Menengah",
            high: "Tinggi",
            critical: "Kritis",
          };
          return labels[priority] || priority;
        }

        getCategoryLabel(category) {
          const labels = {
            personal: "Personal",
            professional: "Profesional",
            ideas: "Ide",
            reflection: "Refleksi",
            learning: "Pembelajaran",
            salary: "Gaji",
            freelance: "Freelance",
            investment: "Investasi",
            food: "Makanan & Restoran",
            transport: "Transportasi",
            entertainment: "Hiburan",
            shopping: "Belanja",
            bills: "Tagihan & Utilitas",
            other: "Lainnya",
          };
          return labels[category] || category;
        }
      }

      // ===== ADVANCED VOICE ASSISTANT =====
      class AdvancedVoiceAssistant {
        constructor(app) {
          this.app = app;
          this.isListening = false;
          this.recognition = null;
          this.context = {};
          this.init();
        }

        init() {
          if (
            "webkitSpeechRecognition" in window ||
            "SpeechRecognition" in window
          ) {
            const SpeechRecognition =
              window.SpeechRecognition || window.webkitSpeechRecognition;
            this.recognition = new SpeechRecognition();
            this.recognition.continuous = false;
            this.recognition.interimResults = true;
            this.recognition.lang = "id-ID"; // Bahasa Indonesia

            this.recognition.onstart = () => {
              this.isListening = true;
              $("#voiceButton").classList.add("listening");
              $("#voiceTranscript").textContent = "Mendengarkan...";
            };

            this.recognition.onresult = (event) => {
              let transcript = "";
              for (let i = event.resultIndex; i < event.results.length; i++) {
                if (event.results[i].isFinal) {
                  transcript += event.results[i][0].transcript;
                }
              }

              if (transcript) {
                $("#voiceTranscript").textContent = transcript;
                this.processNaturalLanguage(transcript);
              }
            };

            this.recognition.onend = () => {
              this.stopListening();
            };

            this.recognition.onerror = (event) => {
              console.error("Speech recognition error:", event.error);
              this.stopListening();
              $("#voiceResponse").textContent =
                "Maaf, ada error dengan pengenalan suara.";
            };
          } else {
            $("#voiceResponse").textContent =
              "Browser Anda tidak mendukung pengenalan suara.";
          }
        }

        toggle() {
          if (!this.recognition) {
            $("#voiceResponse").textContent =
              "Pengenalan suara tidak didukung di browser Anda.";
            return;
          }

          if (this.isListening) {
            this.stopListening();
          } else {
            this.startListening();
          }
        }

        startListening() {
          try {
            this.recognition.start();
            $("#voicePanel").classList.add("active");
          } catch (error) {
            console.error("Error starting recognition:", error);
          }
        }

        stopListening() {
          this.isListening = false;
          $("#voiceButton").classList.remove("listening");
        }

        processNaturalLanguage(transcript) {
          const command = transcript.toLowerCase();
          let response = "";

          // Normalize Indonesian casual speech
          const normalizedCommand = this.normalizeIndonesianSpeech(command);

          // Task commands dengan bahasa santai
          if (
            normalizedCommand.includes("tugas") ||
            normalizedCommand.includes("todo") ||
            normalizedCommand.includes("kerjaan") ||
            normalizedCommand.includes("pekerjaan")
          ) {
            if (
              normalizedCommand.includes("tambah") ||
              normalizedCommand.includes("buat") ||
              normalizedCommand.includes("baru") ||
              normalizedCommand.includes("bikin")
            ) {
              const taskText = this.extractTaskText(normalizedCommand);
              if (taskText) {
                this.app.state.tasks.unshift({
                  id: Date.now(),
                  text: taskText,
                  priority: "medium",
                  completed: false,
                  createdAt: new Date().toISOString(),
                });
                this.app.saveState();
                this.app.renderTasks();
                response = `Oke, tugas "${taskText}" sudah ditambahkan.`;
              }
            } else if (
              normalizedCommand.includes("selesai") ||
              normalizedCommand.includes("sudah") ||
              normalizedCommand.includes("beres")
            ) {
              response = `Ada ${
                this.app.state.tasks.filter((t) => !t.completed).length
              } tugas yang belum selesai.`;
            }
          }
          // Finance commands dengan bahasa santai
          else if (
            normalizedCommand.includes("uang") ||
            normalizedCommand.includes("duit") ||
            normalizedCommand.includes("keuangan") ||
            normalizedCommand.includes("pengeluaran") ||
            normalizedCommand.includes("pemasukan")
          ) {
            if (
              normalizedCommand.includes("keluar") ||
              normalizedCommand.includes("habis") ||
              normalizedCommand.includes("beli") ||
              normalizedCommand.includes("bayar")
            ) {
              const amount = this.extractAmount(normalizedCommand);
              if (amount) {
                this.app.state.transactions.unshift({
                  id: Date.now(),
                  type: "expense",
                  amount: amount,
                  category: "other",
                  note: "Pengeluaran via perintah suara",
                  date: new Date().toISOString(),
                });
                this.app.state.balance -= amount;
                this.app.saveState();
                this.app.renderFinance();
                response = `Pengeluaran ${this.app.formatCurrency(
                  amount
                )} sudah dicatat.`;
              }
            } else if (
              normalizedCommand.includes("masuk") ||
              normalizedCommand.includes("dapat") ||
              normalizedCommand.includes("terima")
            ) {
              const amount = this.extractAmount(normalizedCommand);
              if (amount) {
                this.app.state.transactions.unshift({
                  id: Date.now(),
                  type: "income",
                  amount: amount,
                  category: "other",
                  note: "Pemasukan via perintah suara",
                  date: new Date().toISOString(),
                });
                this.app.state.balance += amount;
                this.app.saveState();
                this.app.renderFinance();
                response = `Pemasukan ${this.app.formatCurrency(
                  amount
                )} sudah dicatat.`;
              }
            } else if (
              normalizedCommand.includes("saldo") ||
              normalizedCommand.includes("berapa") ||
              normalizedCommand.includes("sisa")
            ) {
              response = `Saldo Anda saat ini ${this.app.formatCurrency(
                this.app.state.balance
              )}.`;
            }
          }
          // Journal commands
          else if (
            normalizedCommand.includes("catat") ||
            normalizedCommand.includes("tulis") ||
            normalizedCommand.includes("ingat") ||
            normalizedCommand.includes("simpan")
          ) {
            const content = this.extractTextAfter(normalizedCommand, [
              "catat",
              "tulis",
              "ingat",
              "simpan",
            ]);
            if (content) {
              this.app.state.journalEntries.unshift({
                id: Date.now(),
                title: "Entri suara",
                content: content,
                category: "personal",
                createdAt: new Date().toISOString(),
              });
              this.app.saveState();
              this.app.renderJournal();
              response = "Oke, sudah dicatat di jurnal.";
            }
          }
          // General queries dengan bahasa santai
          else if (
            normalizedCommand.includes("berapa") ||
            normalizedCommand.includes("progress") ||
            normalizedCommand.includes("status") ||
            normalizedCommand.includes("gimana")
          ) {
            const completedTasks = this.app.state.tasks.filter(
              (t) => t.completed
            ).length;
            const totalTasks = this.app.state.tasks.length;
            response = `Ada ${completedTasks} dari ${totalTasks} tugas yang sudah selesai. Saldo Anda ${this.app.formatCurrency(
              this.app.state.balance
            )}.`;
          }
          // Greetings
          else if (
            normalizedCommand.includes("halo") ||
            normalizedCommand.includes("hai") ||
            normalizedCommand.includes("p") ||
            normalizedCommand.includes("assalamualaikum")
          ) {
            response =
              "Halo! Saya asisten AI Ganesa Hub. Ada yang bisa saya bantu?";
          }
          // Help
          else if (
            normalizedCommand.includes("bantu") ||
            normalizedCommand.includes("bantuan") ||
            normalizedCommand.includes("bisa apa")
          ) {
            response =
              'Saya bisa membantu: tambah tugas, catat pengeluaran/pemasukan, tulis di jurnal, atau cek progress. Coba katakan "tambah tugas meeting besok" atau "catat pengeluaran 50 ribu untuk makan".';
          } else {
            response =
              'Maaf, saya belum paham. Coba katakan "tambah tugas" atau "catat pengeluaran".';
          }

          $("#voiceResponse").textContent = response;
          this.speak(response);
        }

        normalizeIndonesianSpeech(command) {
          // Normalize casual Indonesian speech patterns
          return command
            .replace(/gue|gw/g, "saya")
            .replace(/lu|elo/g, "anda")
            .replace(/gak|ga|nggak/g, "tidak")
            .replace(/udah/g, "sudah")
            .replace("/blm|belom/g", "belum")
            .replace(/duit/g, "uang")
            .replace(/bikin|buat/g, "tambah")
            .replace(/kerjaan/g, "tugas")
            .replace(/pengen|pengin/g, "ingin")
            .replace(/mau/g, "ingin")
            .replace(/abis|abisin/g, "habis");
        }

        extractTaskText(command) {
          const triggers = ["tambah", "buat", "baru", "bikin", "ingin"];
          for (const trigger of triggers) {
            const index = command.indexOf(trigger);
            if (index !== -1) {
              let text = command.substring(index + trigger.length).trim();

              // Remove common filler words
              const fillers = ["yang", "untuk", "yaitu", "adalah", "yakni"];
              fillers.forEach((filler) => {
                if (text.startsWith(filler + " ")) {
                  text = text.substring(filler.length + 1);
                }
              });

              return text || "Tugas baru";
            }
          }
          return command;
        }

        extractAmount(command) {
          // Extract numbers with Indonesian currency patterns
          const amountMatch = command.match(
            /(\d+(?:\.\d+)?)\s*(rb|ribu|ratus|juta|k|t)?/
          );
          if (amountMatch) {
            let amount = parseFloat(amountMatch[1]);
            const multiplier = amountMatch[2];

            if (
              multiplier === "rb" ||
              multiplier === "ribu" ||
              multiplier === "k"
            ) {
              amount *= 1000;
            } else if (multiplier === "juta") {
              amount *= 1000000;
            } else if (multiplier === "ratus") {
              amount *= 100;
            }

            return amount;
          }
          return null;
        }

        extractTextAfter(command, keywords) {
          for (const keyword of keywords) {
            const index = command.indexOf(keyword);
            if (index !== -1) {
              return command.substring(index + keyword.length).trim();
            }
          }
          return command;
        }

        speak(text) {
          if ("speechSynthesis" in window) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = "id-ID";
            utterance.rate = 0.9;
            utterance.pitch = 1;
            speechSynthesis.speak(utterance);
          }
        }
      }

      // ===== TELEGRAM BOT INTEGRATION =====
      class TelegramBotIntegration {
        constructor(app) {
          this.app = app;
          this.baseUrl = "https://api.telegram.org/bot";
        }

        async sendMessage(message) {
          const config = this.app.state.settings.telegramConfig;
          if (!config) return;

          try {
            const url = `${this.baseUrl}${config.token}/sendMessage`;
            const response = await fetch(url, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                chat_id: config.chatId,
                text: message,
                parse_mode: "HTML",
              }),
            });

            if (!response.ok) {
              console.error("Telegram API error:", await response.text());
            }
          } catch (error) {
            console.error("Failed to send Telegram message:", error);
          }
        }

        async notifyNewTask(task) {
          const message =
            `üìù <b>Tugas Baru Ditambahkan</b>\n\n` +
            `Tugas: ${task.text}\n` +
            `Prioritas: ${this.app.getPriorityLabel(task.priority)}\n` +
            `Ditambahkan: ${this.app.formatDate(task.createdAt)}`;

          await this.sendMessage(message);
        }

        async notifyTransaction(transaction) {
          const emoji = transaction.type === "income" ? "üí∞" : "üí∏";
          const message =
            `${emoji} <b>${
              transaction.type === "income" ? "Pemasukan" : "Pengeluaran"
            } Baru</b>\n\n` +
            `Jumlah: ${this.app.formatCurrency(transaction.amount)}\n` +
            `Kategori: ${this.app.getCategoryLabel(transaction.category)}\n` +
            `Keterangan: ${transaction.note}\n` +
            `Saldo Baru: ${this.app.formatCurrency(this.app.state.balance)}`;

          await this.sendMessage(message);
        }

        async notifyGoalCompleted(goal) {
          const message =
            `üéØ <b>Goal Tercapai!</b>\n\n` +
            `Goal: ${goal.title}\n` +
            `Progress: 100%\n` +
            `Dicapai: ${this.app.formatDate(new Date().toISOString())}\n\n` +
            `Selamat! üéâ`;

          await this.sendMessage(message);
        }
      }

      // ===== INITIALIZE APPLICATION =====
      const ganesaHub = new GanesaHubEnterprise();

      // Make app globally available for event handlers
      window.ganesaHub = ganesaHub;
    </script>
</body>
</html>